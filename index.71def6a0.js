!function(){class e{static getRandomTileValue(){let e={2:.9,4:.1},t=Math.random()*Object.values(e).reduce((e,t)=>e+t,0);for(let i in e)if((t-=e[i])<=0)return Number(i);return e[Object.values(e)[0]]}}let t={duration:150,fill:"forwards"},i={duration:200,easing:"ease"};new class{#e;#t;#i;#l;#s;#n;#h;#d;constructor(){this.#e=10,this.#t=!1,this.#i=0,this.#h=[[null,null,null,null],[null,null,null,null],[null,null,null,null],[null,null,null,null]],this.#l=document.getElementById("field"),this.#s=this.#l.getBoundingClientRect().width,this.#n=(this.#s-this.#e*(this.#h.length+1))/this.#h.length,this.#d={ArrowDown:this.#o.bind(this),ArrowUp:this.#r.bind(this),ArrowLeft:this.#a.bind(this),ArrowRight:this.#u.bind(this)},this.#h=[[null,null,null,null],[null,null,null,null],[null,null,null,null],[null,null,null,null]]}init(){this.#f(),this.#f(),this.#c(),this.#m(),document.addEventListener("keydown",e=>{if(this.#t)return;let t=this.#d[e.code];e.preventDefault(),t&&t()?.then(()=>{[].forEach.call(document.querySelectorAll(".tile"),e=>{e.parentNode.removeChild(e)}),this.#m()})}),document.querySelector(".reset-button")?.addEventListener("click",this.#S.bind(this))}#S(){this.#h=[[null,null,null,null],[null,null,null,null],[null,null,null,null],[null,null,null,null]],this.#i=0,this.#g(0),this.init()}#g(e){let t=document.querySelector("#score-number");t&&(this.#i+=e,t.innerText=this.#i.toString())}#f(){let t=[];this.#h.forEach((e,i)=>{e.forEach((e,l)=>{e||t.push({x:i,y:l})})});let i=t.length-1,l=t[Math.floor(Math.random()*(i-0)+0)];l&&(this.#h[l.x][l.y]=e.getRandomTileValue())}#m(){this.#h.forEach((e,t)=>{e.forEach((e,i)=>{if(!e)return;let l=document.createElement("div");l.classList.add("tile"),l.style.width=`${this.#n}px`,l.style.height=`${this.#n}px`;let s=this.#n*t+this.#e*(t+1),n=this.#n*i+this.#e*(i+1);l.style.left=`${n}px`,l.style.top=`${s}px`,l.dataset.row=t.toString(),l.dataset.col=i.toString(),l.innerText=e.toString(),this.#l.appendChild(l)})})}#c(){this.#h.forEach((e,t)=>{e.forEach((e,i)=>{let l=document.createElement("div");l.classList.add("bgTile"),l.style.width=`${this.#n}px`,l.style.height=`${this.#n}px`;let s=this.#n*t+this.#e*(t+1),n=this.#n*i+this.#e*(i+1);l.style.left=`${n}px`,l.style.top=`${s}px`,this.#l.appendChild(l)})})}#E(e,i,l,s){this.#t=!0,e.animate({[i]:`${l}px`},t).finished.then(()=>{this.#t=!1,s()})}#T(e,l,s,n,h){this.#t=!0,e.animate({[l]:`${s}px`},t).finished.then(()=>{e.innerText=n.toString(),e.animate({transform:"scale(1.1)"},i).finished.then(()=>{this.#t=!1,h(null)})})}#a(){let e=[],t=!1;for(let i=0;i<this.#h.length;i++)for(let l=0;l<=this.#h.length-1;l++)for(let s=l+1;s<=this.#h.length-1;s++){if(!this.#h[i][s])continue;let n=document.querySelector(`[data-row="${i}"][data-col="${s}"]`);if(!n)return Promise.reject();if(!this.#h[i][l]){this.#t=!0;let h=new Promise(e=>{let t=this.#n*l+this.#e*(l+1);n.dataset.col=l.toString(),this.#E(n,"left",t,e),this.#h[i][l]=this.#h[i][s],this.#h[i][s]=null});t=!0,e.push(h);continue}if(this.#h[i][l]===this.#h[i][s]){let h=new Promise(e=>{let t=this.#n*l+this.#e*(l+1);n.dataset.col=l.toString();let h=2*this.#h[i][s];this.#T(n,"left",t,h,e),this.#h[i][l]=h,this.#h[i][s]=null,this.#g(h)});t=!0,e.push(h)}break}return t&&this.#f(),Promise.all(e)}#u(){let e=[],t=!1;for(let i=0;i<this.#h.length;i++)for(let l=this.#h.length-1;l>=0;l--)for(let s=l-1;s>=0;s--){if(!this.#h[i][s])continue;let n=document.querySelector(`[data-row="${i}"][data-col="${s}"]`);if(!n)return Promise.reject();if(!this.#h[i][l]){this.#t=!0;let h=new Promise(e=>{let t=this.#n*l+this.#e*(l+1);n.dataset.col=l.toString(),this.#E(n,"left",t,e),this.#h[i][l]=this.#h[i][s],this.#h[i][s]=null});t=!0,e.push(h);continue}if(this.#h[i][l]===this.#h[i][s]){let h=new Promise(e=>{let t=this.#n*l+this.#e*(l+1);n.dataset.col=l.toString();let h=2*this.#h[i][s];this.#T(n,"left",t,h,e),this.#h[i][l]=h,this.#h[i][s]=null,this.#g(h)});t=!0,e.push(h)}break}return t&&this.#f(),Promise.all(e)}#o(){let e=[],t=!1;for(let i=0;i<this.#h.length;i++)for(let l=this.#h.length-1;l>=0;l--)for(let s=l-1;s>=0;s--){if(!this.#h[s][i])continue;let n=document.querySelector(`[data-row="${s}"][data-col="${i}"]`);if(!n)return Promise.reject();if(!this.#h[l][i]){this.#t=!0;let h=new Promise(e=>{let t=this.#n*l+this.#e*(l+1);n.dataset.row=l.toString(),this.#E(n,"top",t,e),this.#h[l][i]=this.#h[s][i],this.#h[s][i]=null});t=!0,e.push(h);continue}if(this.#h[l][i]===this.#h[s][i]){let h=new Promise(e=>{let t=this.#n*l+this.#e*(l+1);n.dataset.row=l.toString();let h=2*this.#h[s][i];this.#T(n,"top",t,h,e),this.#h[l][i]=h,this.#h[s][i]=null,this.#g(h)});t=!0,e.push(h)}break}return t&&this.#f(),Promise.all(e)}#r(){let e=[],t=!1;for(let i=0;i<this.#h.length;i++)for(let l=0;l<=this.#h.length-1;l++)for(let s=l+1;s<=this.#h.length-1;s++){if(!this.#h[s][i])continue;let n=document.querySelector(`[data-row="${s}"][data-col="${i}"]`);if(!n)return Promise.reject();if(!this.#h[l][i]){this.#t=!0;let h=new Promise(e=>{let t=this.#n*l+this.#e*(l+1);n.dataset.row=l.toString(),this.#E(n,"top",t,e),this.#h[l][i]=this.#h[s][i],this.#h[s][i]=null});t=!0,e.push(h);continue}if(this.#h[l][i]===this.#h[s][i]){let h=new Promise(e=>{let t=this.#n*l+this.#e*(l+1);n.dataset.row=l.toString();let h=2*this.#h[s][i];this.#T(n,"top",t,h,e),this.#h[l][i]=h,this.#h[s][i]=null,this.#g(h)});t=!0,e.push(h)}break}return t&&this.#f(),Promise.all(e)}}().init()}();
//# sourceMappingURL=index.71def6a0.js.map
